<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nail Master CyberApp</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* === üåÜ CYBERPUNK –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò === */
        body { 
            font-family: 'Segoe UI', sans-serif; 
            /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω —Å —Ü–∏—Ñ—Ä–æ–≤–æ–π —Å–µ—Ç–∫–æ–π */
            background-color: #050510;
            background-image: 
                linear-gradient(rgba(236, 72, 153, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            color: #e0e0ff;
        }

        /* –§—É—Ç—É—Ä–∏—Å—Ç–∏—á–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
        .font-cyber { font-family: 'Orbitron', sans-serif; }

        /* –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ */
        .neon-text-pink { text-shadow: 0 0 5px #ec4899, 0 0 15px #ec4899; }
        .neon-text-blue { text-shadow: 0 0 5px #06b6d4, 0 0 15px #06b6d4; }

        /* –ö–∏–±–µ—Ä-–ø–∞–Ω–µ–ª—å (–≤–º–µ—Å—Ç–æ —Å—Ç–µ–∫–ª–∞) */
        .cyber-panel {
            background: rgba(10, 10, 20, 0.8);
            border: 2px solid #ec4899;
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.3), inset 0 0 20px rgba(6, 182, 212, 0.1);
            /* –û–±—Ä–µ–∑–∞–Ω–Ω—ã–π —É–≥–æ–ª –≤ —Å—Ç–∏–ª–µ sci-fi */
            clip-path: polygon(0 0, 100% 0, 100% 90%, 90% 100%, 0 100%);
            backdrop-filter: blur(5px);
        }

        /* –ö–∏–±–µ—Ä-–∏–Ω–ø—É—Ç */
        .cyber-input {
            background: rgba(0, 0, 0, 0.5) !important;
            border: none !important;
            border-left: 3px solid #ec4899 !important; /* –†–æ–∑–æ–≤–∞—è –ø–æ–ª–æ—Å–∞ —Å–ª–µ–≤–∞ */
            border-bottom: 1px solid #06b6d4 !important; /* –ì–æ–ª—É–±–∞—è –ø–æ–ª–æ—Å–∞ —Å–Ω–∏–∑—É */
            color: #06b6d4 !important; /* –ì–æ–ª—É–±–æ–π —Ç–µ–∫—Å—Ç */
            font-family: 'Orbitron', monospace;
            letter-spacing: 1px;
        }
        .cyber-input::placeholder { color: rgba(236, 72, 153, 0.5); }
        .cyber-input:focus {
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.5) !important;
            background: rgba(6, 182, 212, 0.1) !important;
        }

        /* –ö–∏–±–µ—Ä-–∫–Ω–æ–ø–∫–∞ */
        .cyber-button {
            background: linear-gradient(45deg, #ec4899, #06b6d4);
            border: none;
            color: white;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%); /* –°–∫–æ—à–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ */
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.6);
            position: relative;
            overflow: hidden;
        }
        /* –≠—Ñ—Ñ–µ–∫—Ç –±–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
        .cyber-button::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg); animation: btn-shine 3s infinite;
        }
        @keyframes btn-shine { 0% {left: -100%;} 20% {left: 100%;} 100% {left: 100%;} }

        /* –°—Ç–∞—Ä—ã–µ —Å—Ç–∏–ª–∏ (–¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –æ—Å—Ç–∞–≤–∏–º –ø–æ—Å–≤–µ—Ç–ª–µ–µ) */
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .stamp-active { background: linear-gradient(135deg, #f472b6, #a855f7); color: white; border: none; box-shadow: 0 4px 6px rgba(236, 72, 153, 0.3); }
        .stamp-empty { border: 2px dashed #d1d5db; color: transparent; background: #f9fafb; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #ec4899; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useMemo } = React;
    
    // =================================================================
    // üëáüëáüëá –ù–ê–°–¢–†–û–ô–ö–ò üëáüëáüëá
    // =================================================================
    
    const TG_BOT_TOKEN = "8581694314:AAFyOqGsKdAANCy_WuOtrP_8O6th-Tqne4k"; 
    const TG_CHAT_ID = "6744712545";  
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwK-aDaQ6DbtKR9xHUyg-srLw-ga9eSmcFXjkoH4BdISeil1Tk8m7qrSqyUgJidbtGwTQ/exec"; 
    const ADMIN_PASSWORD = "admin";

    // =================================================================

    const IconCheck = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>;
    const IconClock = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
    const IconGift = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 12 20 22 4 22 4 12"></polyline><rect x="2" y="7" width="20" height="5"></rect><line x1="12" y1="22" x2="12" y2="7"></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path></svg>;
    const IconUser = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;
    // –ò–∫–æ–Ω–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
    const IconTerminal = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-cyan-400"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>;

    const App = () => {
        const tg = window.Telegram.WebApp;
        const userTelegramId = tg.initDataUnsafe?.user?.id;
        const isOwner = String(userTelegramId) === String(TG_CHAT_ID);

        useEffect(() => { tg.expand(); tg.ready(); 
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º–Ω—ã–π —Ü–≤–µ—Ç —Ö–µ–¥–µ—Ä–∞ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º
            tg.setHeaderColor('#050510');
            tg.setBackgroundColor('#050510');
        }, []);

        // --- –°–û–°–¢–û–Ø–ù–ò–ï ---
        const [view, setView] = useState('login'); 
        const [currentUser, setCurrentUser] = useState(null);
        const [bookings, setBookings] = useState([]); 
        const [loading, setLoading] = useState(false); 

        const [loginForm, setLoginForm] = useState({ name: '', phone: '', address: '' });
        const [adminPass, setAdminPass] = useState('');

        const schedule = {
            '–ü–Ω': ['10:00', '12:00', '14:00', '16:00'],
            '–í—Ç': ['10:00', '12:00', '14:00', '16:00'],
            '–°—Ä': ['10:00', '12:00', '14:00', '16:00'],
            '–ß—Ç': ['10:00', '12:00', '14:00', '16:00'],
            '–ü—Ç': ['10:00', '12:00', '14:00'],
        };

        // --- –§–£–ù–ö–¶–ò–ò GOOGLE ---
        const fetchBookings = async () => {
            setLoading(true);
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL);
                const data = await response.json();
                setBookings(data); 
            } catch (error) { console.error("–û—à–∏–±–∫–∞:", error); }
            setLoading(false);
        };
        useEffect(() => { fetchBookings(); }, []);

        const createBooking = async (day, time, isBonus = false, customPhone = null, customName = null) => {
            setLoading(true);
            const bookingId = Date.now();
            const useName = customName || currentUser.name;
            const usePhone = customPhone || currentUser.phone;
            const useAddress = currentUser ? currentUser.address : "–ë–æ–Ω—É—Å –æ—Ç –ê–¥–º–∏–Ω–∞";

            const newBooking = { id: bookingId, name: useName, phone: usePhone, address: useAddress, day, time, status: 'pending' };
            setBookings(prev => [...prev, newBooking]);
            
            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST', mode: 'no-cors',
                    body: JSON.stringify({ action: 'create', id: bookingId, name: useName, phone: usePhone, address: useAddress, day, time })
                });
                if(!isBonus) alert("–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
            } catch(e) { alert("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"); }
            setLoading(false);
            if(!isBonus) setView('client');
        };

        const confirmBooking = async (bookingId) => {
            setLoading(true);
            const updated = bookings.map(b => String(b.id) === String(bookingId) ? { ...b, status: 'confirmed' } : b);
            setBookings(updated);
            try {
                await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ action: 'confirm', id: bookingId }) });
            } catch(e) {}
            setLoading(false);
        };

        // --- –õ–û–ì–ò–ö–ê –ü–ï–ß–ê–¢–ï–ô ---
        const calculateStamps = (phone) => {
            if (!phone) return 0;
            const confirmedCount = bookings.filter(b => String(b.phone) === String(phone) && b.status === 'confirmed').length;
            return confirmedCount % 6;
        };

        const uniqueClients = useMemo(() => {
            const clientsMap = {};
            bookings.forEach(b => {
                if (b.phone && b.name) clientsMap[b.phone] = { name: b.name, phone: b.phone };
            });
            return Object.values(clientsMap);
        }, [bookings]);


        // --- –ò–ù–¢–ï–†–§–ï–ô–° ---
        const handleClientLogin = () => {
            if (!loginForm.name || !loginForm.phone || !loginForm.address) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞");
            setCurrentUser(loginForm);
            fetchBookings();
            setView('client');
        };

        const handleAdminLogin = () => {
            if (adminPass === ADMIN_PASSWORD) { fetchBookings(); setView('admin'); } else alert("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω");
        };

        const handleBonusStamp = (clientName, clientPhone) => {
            if(confirm(`–ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å –∫–ª–∏–µ–Ω—Ç—É ${clientName}?`)) {
                const today = new Date().toLocaleDateString('ru-RU', {weekday: 'short'});
                createBooking(today, "üéÅ –ë–û–ù–£–°", true, clientPhone, clientName);
                alert("–ë–æ–Ω—É—Å —Å–æ–∑–¥–∞–Ω. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤ –∑–∞—è–≤–∫–∞—Ö.");
            }
        };

        // --- RENDER ---

        // üî•üî•üî• –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê –í –°–¢–ò–õ–ï CYBERPUNK üî•üî•üî•
        if (view === 'login') {
            return (
                // –§–æ–Ω —É–∂–µ –∑–∞–¥–∞–Ω –≤ body, —Ç—É—Ç –ø—Ä–æ—Å—Ç–æ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º
                <div className="min-h-screen flex items-center justify-center p-4">
                    {/* –ö–∏–±–µ—Ä-–ø–∞–Ω–µ–ª—å */}
                    <div className="cyber-panel p-8 w-full max-w-sm text-center relative overflow-hidden fade-in">
                        
                        {/* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç: —Å–∫–∞–Ω–∏—Ä—É—é—â–∞—è –ª–∏–Ω–∏—è */}
                        <div className="absolute top-0 left-0 w-full h-1 bg-cyan-400 opacity-50 animate-pulse"></div>
                        
                        <div className="text-6xl mb-4 relative inline-block">
                            üíÖ
                            {/* –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –∑–∞ –∏–∫–æ–Ω–∫–æ–π */}
                            <div className="absolute inset-0 bg-pink-500 blur-xl opacity-30 -z-10 animate-pulse"></div>
                        </div>
                        
                        <h1 className="text-3xl font-bold mb-6 font-cyber text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-cyan-400 neon-text-pink">
                            CYBER NAILS
                            <span className="block text-xs text-cyan-300 font-normal mt-1 tracking-widest opacity-70">SYSTEM V.2.077</span>
                        </h1>
                        
                        <div className="space-y-5 relative z-10">
                            {isOwner && <p className="text-cyan-400 font-bold text-sm font-cyber tracking-wider animate-pulse">/// ADMIN DETECTED ///</p>}
                            
                            {/* –ö–∏–±–µ—Ä-–∏–Ω–ø—É—Ç—ã */}
                            <div className="relativeGroup">
                                <input placeholder="–ò–ú–Ø_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø" value={loginForm.name} onChange={e => setLoginForm({...loginForm, name: e.target.value})} className="w-full p-3 rounded-none outline-none transition-all cyber-input"/>
                            </div>
                            <div className="relativeGroup">
                                <input type="tel" placeholder="–ö–û–î_–î–û–°–¢–£–ü–ê (–¢–ï–õ–ï–§–û–ù)" value={loginForm.phone} onChange={e => setLoginForm({...loginForm, phone: e.target.value})} className="w-full p-3 rounded-none outline-none transition-all cyber-input"/>
                            </div>
                            <div className="relativeGroup">
                                <input placeholder="–õ–û–ö–ê–¶–ò–Ø (–ê–î–†–ï–°)" value={loginForm.address} onChange={e => setLoginForm({...loginForm, address: e.target.value})} className="w-full p-3 rounded-none outline-none transition-all cyber-input"/>
                            </div>
                            
                            {/* –ö–∏–±–µ—Ä-–∫–Ω–æ–ø–∫–∞ */}
                            <button onClick={handleClientLogin} className="w-full py-4 mt-4 rounded-none font-bold text-lg transition transform active:scale-95 cyber-button">
                                –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–•–û–î–ê
                            </button>
                        </div>

                        {isOwner && (
                            <div className="mt-10 border-t border-pink-500/30 pt-4">
                                <div className="flex items-center gap-2 mb-2 justify-center opacity-70">
                                    <IconTerminal />
                                    <p className="text-sm text-cyan-300 font-cyber">–¢–ï–†–ú–ò–ù–ê–õ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</p>
                                </div>
                                <div className="flex gap-2">
                                    <input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value={adminPass} onChange={e => setAdminPass(e.target.value)} className="w-full p-2 border-none text-sm bg-black/50 text-pink-500 font-cyber outline-none focus:ring-1 focus:ring-pink-500"/>
                                    <button onClick={handleAdminLogin} className="px-4 bg-pink-600 hover:bg-pink-700 text-white rounded-none text-sm font-bold font-cyber border-l-2 border-cyan-400">‚ûú</button>
                                </div>
                            </div>
                        )}
                         {/* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç: —É–≥–æ–ª */}
                        <div className="absolute bottom-0 right-0 w-8 h-8 border-r-2 border-b-2 border-cyan-400 opacity-50"></div>
                    </div>
                </div>
            );
        }

        // --- –û–°–¢–ê–õ–¨–ù–´–ï –°–¢–†–ê–ù–ò–¶–´ (–û—Å—Ç–∞–≤–ª—è–µ–º —Å–≤–µ—Ç–ª—ã–º–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ –∏ —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è) ---
        
        if (view === 'client') {
            const myBookings = bookings.filter(b => String(b.phone) === String(currentUser.phone));
            const myStamps = calculateStamps(currentUser.phone);
            
            return (
                // –í–µ—Ä–Ω–µ–º —Å–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
                <div className="min-h-screen p-4 bg-gray-50 max-w-md mx-auto fade-in" style={{backgroundColor: '#f3f4f6', color: '#1f2937'}}>
                    <div className="flex justify-between items-center mb-6">
                        <div>
                            <h2 className="text-2xl font-bold text-gray-800">{currentUser.name}</h2>
                            <p className="text-xs text-gray-500">üìç {currentUser.address}</p>
                        </div>
                        <button onClick={() => setView('login')} className="text-sm text-pink-500 font-bold">–í–´–ô–¢–ò</button>
                    </div>

                    <div className="bg-white p-6 rounded-3xl shadow-lg mb-6 relative overflow-hidden">
                        <div className="absolute top-0 right-0 bg-yellow-400 text-xs font-bold px-3 py-1 rounded-bl-xl text-gray-800">–ê–ö–¶–ò–Ø -50%</div>
                        <h3 className="font-bold text-gray-700 mb-4 flex items-center gap-2"><IconGift className="text-pink-500" /> –ú–æ—è –ª–æ—è–ª—å–Ω–æ—Å—Ç—å</h3>
                        
                        <div className="grid grid-cols-6 gap-2">
                            {[...Array(6)].map((_, i) => (
                                <div key={i} className={`aspect-square rounded-lg flex items-center justify-center text-lg font-bold transition-all duration-500 ${i < myStamps ? 'stamp-active scale-105' : 'stamp-empty'}`}>
                                    {i < myStamps && <IconCheck />}
                                </div>
                            ))}
                        </div>
                        <p className="text-center text-sm text-gray-500 mt-4 font-medium">
                            {myStamps === 0 && bookings.length > 0 && bookings.some(b => b.status === 'confirmed') 
                                ? 'üéâ –°–∫–∏–¥–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–∫–∞–∑!' 
                                : `–°–æ–±–µ—Ä–∏—Ç–µ –µ—â–µ ${6 - myStamps} –ø–µ—á–∞—Ç–∏ –¥–ª—è —Å–∫–∏–¥–∫–∏ 50%`}
                        </p>
                    </div>

                    <button onClick={() => setView('booking')} className="w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl font-bold text-xl shadow-lg mb-6 transform active:scale-95 transition">üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>

                    <h3 className="font-bold text-gray-700 mb-3 flex items-center gap-2">–ò—Å—Ç–æ—Ä–∏—è {loading && <div className="loader"></div>}</h3>
                    <div className="space-y-3 pb-10">
                        {myBookings.length === 0 && <p className="text-gray-400 text-sm">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>}
                        {myBookings.slice().reverse().map(b => (
                            <div key={b.id} className="bg-white p-4 rounded-xl shadow-sm flex flex-col gap-1 border-l-4" style={{ borderColor: b.status === 'confirmed' ? '#10b981' : '#f59e0b' }}>
                                <div className="flex justify-between items-center">
                                    <p className="font-bold text-gray-800">{b.day} {b.time}</p>
                                    <div className={`px-3 py-1 rounded-full text-xs font-bold ${b.status === 'confirmed' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}`}>
                                        {b.status === 'confirmed' ? (b.time === 'üéÅ –ë–û–ù–£–°' ? 'üéÅ –ü–æ–¥–∞—Ä–æ–∫' : '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ') : '–û–∂–∏–¥–∞–Ω–∏–µ'}
                                    </div>
                                </div>
                                <p className="text-xs text-gray-400">üìç {b.address}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        if (view === 'booking') {
            return (
                <div className="min-h-screen p-4 bg-gray-50 max-w-md mx-auto fade-in" style={{backgroundColor: '#f3f4f6', color: '#1f2937'}}>
                    <button onClick={() => setView('client')} className="mb-4 text-gray-500 font-medium">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2 className="text-2xl font-bold mb-6 text-gray-800">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</h2>
                    {loading && <div className="flex justify-center mb-4"><div className="loader"></div></div>}
                    <div className="space-y-6 pb-10">
                        {Object.entries(schedule).map(([day, times]) => (
                            <div key={day} className="bg-white p-4 rounded-2xl shadow-sm">
                                <h3 className="font-bold text-pink-600 mb-3 text-lg">{day}</h3>
                                <div className="grid grid-cols-4 gap-2">
                                    {times.map(time => {
                                        const isBusy = bookings.some(b => b.day === day && b.time === time);
                                        return (
                                            <button key={time} disabled={isBusy} onClick={() => createBooking(day, time)} 
                                                className={`py-2 rounded-lg text-sm font-semibold transition ${isBusy ? 'bg-gray-100 text-gray-300 cursor-not-allowed' : 'bg-green-50 text-green-600 border border-green-200 hover:bg-green-100 active:scale-95'}`}>
                                                {time}
                                            </button>
                                        )
                                    })}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        if (view === 'admin') {
            const pending = bookings.filter(b => b.status === 'pending');
            // –ê–¥–º–∏–Ω–∫—É —Ç–æ–∂–µ –æ—Å—Ç–∞–≤–∏–º —Ç–µ–º–Ω–æ–π, –Ω–æ –≤ –¥—Ä—É–≥–æ–º —Å—Ç–∏–ª–µ
            return (
                <div className="min-h-screen p-4 bg-gray-900 text-white max-w-md mx-auto fade-in" style={{backgroundColor: '#111827'}}>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-xl font-bold flex items-center gap-2"><IconTerminal className="text-pink-500"/> –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</h2>
                        <div className="flex gap-4 items-center">
                            {loading && <div className="loader"></div>}
                            <button onClick={() => setView('login')} className="text-sm text-pink-400 hover:text-pink-300">–í–´–ô–¢–ò</button>
                        </div>
                    </div>

                    <div className="mb-8">
                        <h3 className="text-yellow-400 font-bold mb-3 flex items-center gap-2"><IconClock /> –ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ ({pending.length})</h3>
                        <button onClick={fetchBookings} className="text-xs text-cyan-300 mb-3 underline">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                        <div className="space-y-3">
                            {pending.length === 0 && <p className="text-gray-500 text-sm">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</p>}
                            {pending.map(b => (
                                <div key={b.id} className="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-md">
                                    <div className="flex justify-between">
                                        <div>
                                            <p className="font-bold text-lg text-pink-100">{b.name}</p>
                                            <p className="text-sm text-cyan-300">üìû {b.phone}</p>
                                        </div>
                                        {b.time === 'üéÅ –ë–û–ù–£–°' && <span className="text-2xl">üéÅ</span>}
                                    </div>
                                    <p className="text-sm text-yellow-300 mb-2 mt-1">üìç {b.address}</p> 
                                    <p className="text-white font-bold mb-3 bg-gray-700 inline-block px-2 py-1 rounded border border-gray-600">üìÖ {b.day} ‚Äî {b.time}</p>
                                    <button onClick={() => confirmBooking(b.id)} className="w-full py-2 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-lg font-bold transition shadow-lg shadow-green-500/20">
                                        {b.time === 'üéÅ –ë–û–ù–£–°' ? '–ù–∞—á–∏—Å–ª–∏—Ç—å –ø–µ—á–∞—Ç—å ‚úÖ' : '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å ‚úÖ'}
                                    </button>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="mb-8 pb-10">
                        <h3 className="text-pink-400 font-bold mb-3 flex items-center gap-2"><IconUser /> –ë–∞–∑–∞ –ö–ª–∏–µ–Ω—Ç–æ–≤</h3>
                        <div className="bg-gray-800 rounded-xl p-4 space-y-4 border border-gray-700">
                            {uniqueClients.length === 0 && <p className="text-gray-500 text-center">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>}
                            {uniqueClients.map(c => {
                                const stamps = calculateStamps(c.phone);
                                return (
                                    <div key={c.phone} className="flex justify-between items-center border-b border-gray-700 pb-3 last:border-0 last:pb-0">
                                        <div>
                                            <p className="font-bold text-pink-100">{c.name}</p>
                                            <p className="text-xs text-cyan-300 font-mono">{c.phone}</p>
                                            <div className="flex gap-1 mt-2">
                                                {[...Array(6)].map((_, i) => (
                                                    <div key={i} className={`w-2 h-2 rounded-full ${i < stamps ? 'bg-pink-500 shadow-sm shadow-pink-500' : 'bg-gray-700'}`}></div>
                                                ))}
                                            </div>
                                        </div>
                                        <button onClick={() => handleBonusStamp(c.name, c.phone)} className="px-3 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-xs font-bold transition flex items-center gap-1 shadow-blue-500/30 shadow-md">
                                            + üéÅ
                                        </button>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
